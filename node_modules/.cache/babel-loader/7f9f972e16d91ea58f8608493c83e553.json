{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\scarleti\\\\Desktop\\\\Cyril\\\\React\\\\3dHoverBis\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\scarleti\\\\Desktop\\\\Cyril\\\\React\\\\3dHoverBis\\\\src\\\\carPart.js\";\nimport * as THREE from 'three';\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useLoader } from 'react-three-fiber';\nimport usePromise from \"react-promise-suspense\";\nimport { HTML } from \"drei\";\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { useDetectOutsideClick } from \"./useDetectOutsideClick\";\nimport \"./styles.css\";\nimport * as Constants from './constants';\n\nfunction shadeColor(color, percent) {\n  var R = parseInt(color.substring(1, 3), 16);\n  var G = parseInt(color.substring(3, 5), 16);\n  var B = parseInt(color.substring(5, 7), 16);\n  R = parseInt(R * (100 + percent) / 100);\n  G = parseInt(G * (100 + percent) / 100);\n  B = parseInt(B * (100 + percent) / 100);\n  R = R < 255 ? R : 255;\n  G = G < 255 ? G : 255;\n  B = B < 255 ? B : 255;\n  var RR = R.toString(16).length == 1 ? \"0\" + R.toString(16) : R.toString(16);\n  var GG = G.toString(16).length == 1 ? \"0\" + G.toString(16) : G.toString(16);\n  var BB = B.toString(16).length == 1 ? \"0\" + B.toString(16) : B.toString(16);\n  return \"#\" + RR + GG + BB;\n}\n\nexport class CarPart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      description: \"\",\n      index: 0,\n      nColorCodes: \"\",\n      nColor: \"\"\n    };\n    const gltf = useLoader(GLTFLoader, '/carrito.gltf');\n    const ref = useRef(); // const [nColor, setNColor] = useState(color);\n\n    const defaultMaterial = new THREE.MeshPhysicalMaterial({\n      color: this.state.nColor,\n      roughness: 0.8\n    });\n    const hoverMaterial = new THREE.MeshPhysicalMaterial({\n      color: shadeColor(this.state.nColor, -25),\n      roughness: 0.1\n    });\n\n    const Model = () => {\n      const _useState = useState(false),\n            _useState2 = _slicedToArray(_useState, 2),\n            hovered = _useState2[0],\n            setHover = _useState2[1];\n\n      const hover = e => e.stopPropagation() && setHover(true);\n\n      const unhover = e => e.stopPropagation() && setHover(false);\n\n      const dropdownRef = useRef(null);\n\n      const _useDetectOutsideClic = useDetectOutsideClick(dropdownRef, false),\n            _useDetectOutsideClic2 = _slicedToArray(_useDetectOutsideClic, 2),\n            isActive = _useDetectOutsideClic2[0],\n            setIsActive = _useDetectOutsideClic2[1];\n\n      const onMeshClick = () => {\n        /*let data = [\r\n          '#bbb533',\r\n          '#bb55b5',\r\n          '#cccccc'\r\n        ];\r\n        let filtered = Constants.options.filter(item => item.name === description).map(i => i.colorCode);\r\n        for (let i = 0; i < filtered.length; i++) {\r\n          data.push(filtered[i]);\r\n        }*/\n        setIsActive(!isActive);\n      };\n\n      const onMenuClick = color => () => this.state.nColor.setState('white'); // In here it could load textures, images, triangulate textgeometry, etc\n      // The line below produces a fake load, emulating loading assets/set-up processing\n\n\n      usePromise(ms => new Promise(res => setTimeout(res, ms)), [props.time]); // React will bail out until the suspense is lifted, then it renders the view\n\n      return /*#__PURE__*/React.createElement(\"mesh\", {\n        onClick: onMeshClick,\n        onPointerOver: hover,\n        onPointerOut: unhover,\n        material: hovered ? hoverMaterial : defaultMaterial,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"bufferGeometry\", Object.assign({\n        attach: \"geometry\"\n      }, gltf.__$[this.state.index].geometry, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(HTML, {\n        scaleFactor: 10,\n        style: {\n          pointerEvents: \"none\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"content\",\n        style: {\n          display: hovered ? \"block\" : \"none\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        style: {\n          pointerEvents: \"all\"\n        },\n        onClick: e => {\n          e.stopPropagation();\n          e.nativeEvent.stopImmediatePropagation();\n          e.nativeEvent.stopPropagation();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 15\n        }\n      }, !isActive && this.state.description)), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"nav\", {\n        ref: dropdownRef,\n        className: \"menu \".concat(isActive ? \"active\" : \"inactive\"),\n        style: {\n          pointerEvents: \"all\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 17\n        }\n      }, this.state.nColorCodes.map(item => /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 21\n        }\n      })))))));\n    };\n\n    return /*#__PURE__*/React.createElement(\"group\", {\n      ref: ref,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"group\", {\n      scale: [1, 1, 1],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Model, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/scarleti/Desktop/Cyril/React/3dHoverBis/src/carPart.js"],"names":["THREE","React","useState","useRef","useEffect","useLoader","usePromise","HTML","GLTFLoader","useDetectOutsideClick","Constants","shadeColor","color","percent","R","parseInt","substring","G","B","RR","toString","length","GG","BB","CarPart","Component","constructor","props","state","description","index","nColorCodes","nColor","gltf","ref","defaultMaterial","MeshPhysicalMaterial","roughness","hoverMaterial","Model","hovered","setHover","hover","e","stopPropagation","unhover","dropdownRef","isActive","setIsActive","onMeshClick","onMenuClick","setState","ms","Promise","res","setTimeout","time","__$","geometry","pointerEvents","display","nativeEvent","stopImmediatePropagation","map","item"],"mappings":"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","sourcesContent":["import * as THREE from 'three'\r\nimport React, { useState, useRef, useEffect } from 'react'\r\nimport { useLoader } from 'react-three-fiber'\r\nimport usePromise from \"react-promise-suspense\"\r\nimport { HTML } from \"drei\"\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\r\nimport { useDetectOutsideClick } from \"./useDetectOutsideClick\";\r\n\r\nimport \"./styles.css\";\r\n\r\nimport * as Constants from './constants'\r\n\r\nfunction shadeColor(color, percent) {\r\n\r\n  var R = parseInt(color.substring(1,3),16);\r\n  var G = parseInt(color.substring(3,5),16);\r\n  var B = parseInt(color.substring(5,7),16);\r\n\r\n  R = parseInt(R * (100 + percent) / 100);\r\n  G = parseInt(G * (100 + percent) / 100);\r\n  B = parseInt(B * (100 + percent) / 100);\r\n\r\n  R = (R<255)?R:255;  \r\n  G = (G<255)?G:255;  \r\n  B = (B<255)?B:255;  \r\n\r\n  var RR = ((R.toString(16).length==1)?\"0\"+R.toString(16):R.toString(16));\r\n  var GG = ((G.toString(16).length==1)?\"0\"+G.toString(16):G.toString(16));\r\n  var BB = ((B.toString(16).length==1)?\"0\"+B.toString(16):B.toString(16));\r\n\r\n  return \"#\"+RR+GG+BB;\r\n}\r\n\r\nexport class CarPart extends React.Component { \r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      description: \"\",\r\n      index: 0,\r\n      nColorCodes: \"\",\r\n      nColor: \"\"\r\n    };\r\n\r\n    const gltf = useLoader(GLTFLoader, '/carrito.gltf')\r\n    const ref = useRef()\r\n\r\n    // const [nColor, setNColor] = useState(color);\r\n    \r\n    const defaultMaterial = new THREE.MeshPhysicalMaterial({\r\n      color: this.state.nColor,\r\n      roughness: 0.8\r\n    })\r\n\r\n    \r\n    const hoverMaterial = new THREE.MeshPhysicalMaterial({\r\n      color: shadeColor(this.state.nColor, -25),\r\n      roughness: 0.1\r\n    })\r\n\r\n    const Model = () => {\r\n      const [hovered, setHover] = useState(false)\r\n      const hover = e => e.stopPropagation() && setHover(true)\r\n      const unhover = e => e.stopPropagation() && setHover(false)\r\n      \r\n      const dropdownRef = useRef(null);\r\n      const [isActive, setIsActive] = useDetectOutsideClick(dropdownRef, false);\r\n      \r\n      const onMeshClick = () => {\r\n        /*let data = [\r\n          '#bbb533',\r\n          '#bb55b5',\r\n          '#cccccc'\r\n        ];\r\n        let filtered = Constants.options.filter(item => item.name === description).map(i => i.colorCode);\r\n        for (let i = 0; i < filtered.length; i++) {\r\n          data.push(filtered[i]);\r\n        }*/\r\n        \r\n        setIsActive(!isActive);\r\n      }\r\n\r\n      const onMenuClick = color => () => this.state.nColor.setState('white');\r\n\r\n      \r\n      // In here it could load textures, images, triangulate textgeometry, etc\r\n      // The line below produces a fake load, emulating loading assets/set-up processing\r\n      usePromise(ms => new Promise(res => setTimeout(res, ms)), [props.time])\r\n      // React will bail out until the suspense is lifted, then it renders the view\r\n    \r\n      return (\r\n        <mesh\r\n          onClick={onMeshClick}\r\n          onPointerOver={hover}\r\n          onPointerOut={unhover}\r\n          material={hovered ? hoverMaterial : defaultMaterial}>\r\n          <bufferGeometry attach=\"geometry\" {...gltf.__$[this.state.index].geometry} />\r\n          <HTML scaleFactor={10} style={{ pointerEvents: \"none\" }}>\r\n            <div className=\"content\" style={{ display: hovered ? \"block\" : \"none\" }}>\r\n              <button\r\n                style={{ pointerEvents: \"all\" }}\r\n                onClick={e => {\r\n                  e.stopPropagation()\r\n                  e.nativeEvent.stopImmediatePropagation()\r\n                  e.nativeEvent.stopPropagation()\r\n                }}>\r\n                {!isActive && this.state.description}\r\n              </button>\r\n            </div>\r\n            <div>\r\n              <nav \r\n                ref={dropdownRef} \r\n                className={`menu ${isActive ? \"active\" : \"inactive\"}`}\r\n                style={{ pointerEvents: \"all\" }}>\r\n                <ul>\r\n                  {this.state.nColorCodes.map((item) =>\r\n                    <li>\r\n                    </li>\r\n                  )}\r\n                </ul>\r\n              </nav>\r\n            </div>\r\n          </HTML>\r\n        </mesh>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <group ref={ref}>\r\n        <group scale={[1, 1, 1]}>\r\n          <Model />\r\n        </group>\r\n      </group>\r\n    )\r\n    }\r\n  \r\n  \r\n}\r\n"]},"metadata":{},"sourceType":"module"}